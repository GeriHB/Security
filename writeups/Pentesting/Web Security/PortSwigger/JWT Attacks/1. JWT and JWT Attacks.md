JWTs are most commonly used in authentication, session management, and access control mechanisms.

## What are JWT-s?

A standardized format for sending cryptographically signed JSON data between systems.

Unlike with the classic session tokens, all of the data that a server needs is stored client-side within the JWT itself. 

This is why it makes it a popular choice for highly distributed websites where users need to interact seamlessly with the multiple backend servers.

### JWT Format

It has three parts:
- Header 
- Payload
- Signature

The `Header` and the `Payload` are just `base64url-encoded` JSON objects.

Header - metadata about the token.
Payload - claims about the user.

JWT:
```jwt
eyJraWQiOiI5MTM2ZGRiMy1jYjBhLTRhMTktYTA3ZS1lYWRmNWE0NGM4YjUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTY0ODAzNzE2NCwibmFtZSI6IkNhcmxvcyBNb250b3lhIiwic3ViIjoiY2FybG9zIiwicm9sZSI6ImJsb2dfYXV0aG9yIiwiZW1haWwiOiJjYXJsb3NAY2FybG9zLW1vbnRveWEubmV0IiwiaWF0IjoxNTE2MjM5MDIyfQ.SYZBPIBg2CRjXAJ8vCER0LA_ENjII1JakvNQoP-Hw6GG1zfl4JyngsZReIfqRvIAEi5L4HV0q7_9qGhQZvy9ZdxEJbwTxRs_6Lb-fZTDpW6lKYNdMyjw45_alSCZ1fypsMWz_2mTpQzil0lOtps5Ei_z7mM7M8gCwe_AGpI53JxduQOaB5HkT5gVrv9cKu9CsW5MS6ZbqYXpGyOG5ehoxqm8DL5tFYaW3lB50ELxi0KsuTKEbD0t5BCl0aCR2MBJWAbN-xeLwEenaqBiwPVvKixYleeDQiBEIylFdNNIMviKRgXiYuAvMziVPbwSgkZVHeEdF5MQP1Oe2Spac-6IfA
```

The payload:
```jwt
eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTY0ODAzNzE2NCwibmFtZSI6IkNhcmxvcyBNb250b3lhIiwic3ViIjoiY2FybG9zIiwicm9sZSI6ImJsb2dfYXV0aG9yIiwiZW1haWwiOiJjYXJsb3NAY2FybG9zLW1vbnRveWEubmV0IiwiaWF0IjoxNTE2MjM5MDIyfQ
```

Decoded payload:
```json
{
    "iss": "portswigger",
    "exp": 1648037164,
    "name": "Carlos Montoya",
    "sub": "carlos",
    "role": "blog_author",
    "email": "carlos@carlos-montoya.net",
    "iat": 1516239022
}
```

since this can be easily modified by anyone with the access to the token, the security of the JWT is heavy relying on the cryptographic signature.

### JWT Signature

The server that issues the token generates the signature by hashing the header and the payload. 

There are cases where also the resulting hash is encrypted. In both ways, the process involves a secret signing key.

This provides a way for servers to verify that none of the data within the token has been tampered.
- The signature is directly derived from the rest of the token, so if a single byte is changed the signature doesn't match.
- Without knowing the server's secret signing key, it's not possible to generate the correct signature.

### JWT vs JWS vs JWE

JWT only defines a format for representing information as a JSON object that can be transferred between two parties.

JWT is extended by both JWS (JSON Web Signature) and JWE (JSON Web Encryption) which define ways of implementing JWTs.

So a JWT is usually a JWS or if encrypted a JWE.

## JWT Attacks

Typically JWT Attacks happens when an attacker sends a modified JWT to the server to achieve a malicious goal, which typically is to bypass authentication.

The vulnerabilities typically arise due to the flawed JWT handling within the app itself. 

These flaws usually mean that the signature is not verified properly, which enables the attacker to tamper with the values passed to the app via the payload.

But, even if the signature is verified, the safety relies heavily on the server's secret key remaining a secret. If the key is leaked, guessed, or brute-forced, an attacker can generate a valid signature for any token, thus compromising the entire mechanism.