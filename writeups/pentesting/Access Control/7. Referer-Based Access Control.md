Some websites have their access controls based on the `Referer` header in the request.

This can be added by browsers to indicate which page initiated the request.

An example can be when an app enforces access control over the `/admin`, but for `/admin/deleteUser` only inspects the `Referer` header. If it contains the `/admin` then the request is allowed.

This means that the attacker can forge direct request to sub-pages by supplying the `Referer` header.

## Lab.1 - Referer-Based Access Control

In this lab the goal is to promote yourself `wiener:peter` to admin. For this, to familiarize with the admin functionality `administrator:admin` can be used.

When I login as administrator and upgrade the user `carlos`, I observe in Burp the request and responses. I send these to Repeater, and login as `wiener`.

I see that when administrator sent a request to `/admin` the referer header was `lab.net/my-account?id=administrator`. Let's mimic this behavior but with the `wiener` account.

I got `401 Unauthorized`, but let's mimic now the behavior when the admin requested the upgrade of `carlos`. Here the referer was `/admin`, and the request was `GET /admin-roles?username=carlos&action=upgrade HTTP/2`.

And now I got a `302 Found`. Now, let's just change parameters from `carlos` to `wiener` to upgrade ourselves.

And now `wiener` account is upgraded to admin, and the lab is solved.

