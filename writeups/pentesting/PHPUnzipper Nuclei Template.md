# Detecting PHPUnzipper with Nuclei

In this write-up, we will walk through the process of creating a Nuclei template which will be used to detect **PHPUnzipper** tool on a web server.

First we'll install Apache, PHPUnzipper, Nuclei, and then create a Nuclei template for detection. All of this will be done on a Ubuntu Machine.

---
## 1. Installing Apache Web Server

To begin the process, install Apache on your machine. It can be done by running the following commands:

```bash
sudo apt update
sudo apt install apache2 php libapache2-mod-php
```

Now, after the installation, start the Apache web server:

``` bash
sudo systemctl start apache2
```

## 2. Install PHPUnzipper

Clone the repository and set the appropriate permissions for the directory.

```bash
git clone https://github.com/ndeet/unzipper.git /var/www/html/unzipper
sudo chmod -R 755 /var/www/html/unzipper
```

The apache web server and unzipper can be accessed by going to the link:
```url
http://<machine-ip>/unzipper/
```

## 3. Installing Nuclei

Nuclei is written using GO programming language, so first GO has to be installed.

```bash
sudo apt instsall golang-go
```

Now Nuclei can be installed following the given commands:

```bash
git clone https://github.com/projectdiscovery/nuclei.git
cd nuclei/cmd/nuclei
go build
mv nuclei /usr/local/bin/
```

Check if the installation is complete:

```bash
nuclei -version
```

## 4. Creating the Nuclei Template to detect PHPUnzipper

First navigate to the Template Directory:

```bash
cd /home/<user>/nuclei-templates
```

Nuclei Templates are YAML files. Use any editor and write the following template:

```yaml
id: php-unzipper-detect

info:
  name: PHPUnzipper Detect
  author: Halil Berisha
  severity: info
  description: Detecting the PHP Unzipper on its default path

http:
  - method: GET
    path:
      - '{{BaseURL}}/unzipper.php'
      - '{{BaseURL}}/unzipper/unzipper.php'
      - '{{BaseURL}}/unzipper/'

    matchers:
      - type: word
        words:
          - "Unzipper"
      - type: status
        status:
          - 200 
	    - 
```

Now validate the template:

```bash
nuclei -t php-unzipper.yaml -validate
```

After this process, we can start the scan against our apache web server and find the PHPUnzipper:

```bash
nuclei -u localhost -t php-unzipper.yaml
```

And the result on my Linux machine was as follows:

```bash

                     __     _
   ____  __  _______/ /__  (_)
  / __ \/ / / / ___/ / _ \/ /
 / / / / /_/ / /__/ /  __/ /
/_/ /_/\__,_/\___/_/\___/_/   v3.3.7

		projectdiscovery.io

[INF] Current nuclei version: v3.3.7 (latest)
[INF] Current nuclei-templates version: v10.0.4 (latest)
[WRN] Scan results upload to cloud is disabled.
[INF] New templates added in latest release: 74
[INF] Templates loaded for current scan: 1
[WRN] Loading 1 unsigned templates for scan. Use with caution.
[INF] Targets loaded for current scan: 1
[INF] Running httpx on input host
[INF] Found 1 URL from httpx
[php-unzipper-detect] [http] [info] http://localhost/unzipper/unzipper.php
[php-unzipper-detect] [http] [info] http://localhost/unzipper/
```
