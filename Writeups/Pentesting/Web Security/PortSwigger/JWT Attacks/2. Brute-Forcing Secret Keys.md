There are some algorithms such as `HS256 (HMAC + SHA-256)` that use an arbitrary, standalone string as the secret key. 

It's very important that the secret can't be guessed or brute-forced, otherwise an attacker can create JWTs with any header and payload they like and re-sign the token with a valid signature.

When implementing JWT apps, devs sometime forget the change the default or placeholder secrets. 

Some other times, they only copy and paste the code snippets found online, and forget to change the hardcoded secret. For all these cases the attacker can brute-force a server's secret using wordlists.

### Lab.3 - JWT Authentication Bypass via Weak Signing Key

The goal to solve the lab is to brute-force the website's secret key. Use than the key, to sign a modified session token that gives access to `/admin` and delete the user `carlos`.

`wiener:peter` is an account that can be used to sign in.

I intercept the request to login and get the JWT, and save it to a file simply called `token`.

I download the following wordlist to be used with hashcat: https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list

I use hashcat to brute-force the token by using the wordlist, and try to find the key.

`hashcat -a 0 -m 16500 token wordlist`

![Pasted_image_20250123112240](https://github.com/user-attachments/assets/08fd9067-18c3-4d50-8126-73f30d91a38e)

Here I see that it has been cracked, and the key is `secret1`.

I use the Burp to encode it to base64, which gives me `c2VjcmV0MQ==`.

Then I open `JWT Editor` on Burp, and select `New Symmetric Key`, and generate a new key, there I just change then the `"k": `  by putting the base64 encoded key.

![Pasted_image_20250123111658](https://github.com/user-attachments/assets/ff73b338-6e38-4120-a7bd-2c160e52e615)

On Burp Repeater, under JSON Web Token, I modify the `"sub": ` to `administrator` and click on `Sign`, and choose the key that I created before.

![Pasted_image_20250123111815](https://github.com/user-attachments/assets/cdab0262-6008-4ee1-92a4-b800f7cada99)

This changes the `Serliazied JWT` as it is now signed with the cracked key, but for the user `administrator`. I change the `POST` request to `/admin` and I got access to the admin page.

From there I copy the url to delete `carlos` and the lab is solved.

