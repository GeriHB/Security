Happens when a user is able to gain access to the resources that belong to another user.

These attacks can be executed using similar types of exploit methods to vertical privilege escalation.

## 1. Lab - User ID Controlled By Request Parameter

The goal is to obtain the API key for the user `carlos` and submit as a solution. In the lab I can login with the credentials `wiener:peter`.

After I log in, I see the URL is: `...010.web-security-academy.net/my-account?id=wiener`

I change the `wiener` to `carlos`, and I got access to his login page, where I can see also the API key. And the lab is solved.

------------

In some other apps, the exploitable parameter doesn't have a predictable value, and instead of incrementing a number, the app might use GUIDs to identify users.

However, the GUIDs belonging to other users might be disclosed elsewhere in the app where users are references such as messages or reviews.

### 2. Lab - User ID Controlled By Request Parameter, With Unpredictable User IDs

The lab is to find the GUID for `carlos` submit his API key as the solution. In the site you can log in with the credentials `wiener:peter`/

After I logged in I see the link of my account and the id: `my-account?id=ab01f1a9-b30b-4c2b-9c03-eb2b70c50912`

Then I go back to the posts available in the site, and in the post with the `id=3` the author is `carlos`.

I check the response from Burp and search for a similar format to my id.

```html
<span id=blog-author><a href='/blogs?userId=08853903-40f1-4d73-aa06-d69215910c34'>carlos</a></span>
```

In this html snippet, I see the user id of `carlos`, I put that in the url, and I got access to its page, where I can see the API key.
![](../../../images/Pasted image 20250120173740.png)

_____

### 3. Lab - User ID Controlled By Request Parameter With Data Leakage in Redirect

There are some cases when an app detects when the user is not permitted to access a resource and returns a redirect to the login page. But, still the response which contains the redirect can include some sensitive data belongs to the targeted user, and the attack is still successful.

The goal of the lab, obtain the API of the `carlos`. You can login with the following credentials `wiener:peter`.

When I login with the `wiener` account, I see my API key, and the URL to the api key is `lab.com//my-account?id=wiener`

Now, let's modify the URL to `...id=carlos`, and see what happens.

After sending the request the response is not anymore `200 OK` but it's `302 Found`. Still if we take a look at the body, we see it has returned the body of the user `carlos`, and we have the API key.

