Perhaps the simplest initial approach is to try fuzzing the template by injecting a sequence of special characters, which are used in template expressions, such as `${{<%[%'"}}%\`.

If there is some exception, it indicates that the injected syntax is being interpreted by the server.

It's also important to try some context-specific approaches if fuzzing was inconclusive.

#### Plaintext context
Some templates allow to freely input content either by using the HTML tags or the template's native syntax, which then will be rendered to HTML on the backend before the response is sent.

For example, in Freemaker `render('Hello ' + username)` can be exploited for XSS, but it can be also a server-side template injection attack.

We can test it by:

`http://vulnerable-website.com/?username=${7*7}`

and if the result is `Hello 49` it shows that the operation has been done server-side.

#### Code context
In some other cases the vulnerability is by user input being placed within a template expression.

This can take the form of a user-controllable variable name being placed inside a parameter, such as:

```sh
greeting = getQueryParameter('greeting')
engine.render("Hello {{"+greeting+"}}", data)
```

and the URL would be:

`http://vulnerable-website.com/?greeting=data.username`

this would render the output to `Hello Halil`.

This doesn't show a `XSS` and is almost indistinguishable from a simple hashmap lookup. 

To test for Server-Side template injection, first establish that the parameter doesn't contain a direct XSS by injecting arbitrary HTML

`http://vulnerable-website.com/?greeting=data.username<tag>`

This would return a blank entry in the output `Hello ` and now the next step is to try and break out of the statement using common templating syntax to try and inject arbitrary HTML after it:

`http://vulnerable-website.com/?greeting=data.username}}<tag>`

If the output is rendered correctly, with the arbitrary HTML, it is a key indication that the vulnerability is present.

`Hello Carlos<tag>`
